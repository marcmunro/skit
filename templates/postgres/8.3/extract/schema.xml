<?xml version="1.0" encoding="UTF-8"?>

<skit:inclusion
   xmlns:skit="http://www.bloodnok.com/xml/skit"
   xmlns:xi="http://www.w3.org/2003/XInclude">

  <skit:runsql var="schema" file="sql/schemata.sql">
    <schema>
      <skit:attr name="name"/>
      <skit:attr name="owner"/>
      <skit:attr name="privs"/>
      <skit:if test="(select tuple 'comment')">
	<comment>
	  <skit:text expr="(select tuple 'comment')"/>
	</comment>
      </skit:if>

      <skit:if test="(not (select tuple 'privs'))">
  	<grant with_grant="yes" priv="create">
  	  <skit:attr name="from" field="owner"/>
  	  <skit:attr name="to" field="owner"/>
  	</grant>
  	<grant with_grant="yes" priv="usage">
  	  <skit:attr name="from" field="owner"/>
  	  <skit:attr name="to" field="owner"/>
  	</grant>
      </skit:if>
      <skit:exec_function name="grants_from_privs"
  			  privileges="(select tuple 'privs')"/>

      <xi:include href="skitfile:extract/domains.xml"/>
      <xi:include href="skitfile:extract/enums.xml"/>
      <xi:include href="skitfile:extract/basetypes.xml"/>
      <xi:include href="skitfile:extract/comptypes.xml"/>
      <xi:include href="skitfile:extract/functions.xml"/>
      <xi:include href="skitfile:extract/aggregates.xml"/>
      <xi:include href="skitfile:extract/operators.xml"/>
      <xi:include href="skitfile:extract/operator_families.xml"/>
      <xi:include href="skitfile:extract/operator_classes.xml"/>
      <xi:include href="skitfile:extract/sequences.xml"/>
      <xi:include href="skitfile:extract/tables.xml"/>
    </schema>
  </skit:runsql>
  <!-- <skit:exec expr="(debug 'TODO: triggers rules views free-text stuff)"/> -->
</skit:inclusion>


<!-- Keep this comment at the end of the file
Local variables:
mode: xml
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:nil
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:2
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
